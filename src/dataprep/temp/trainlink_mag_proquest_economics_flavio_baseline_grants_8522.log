/home/flavio/miniconda3/envs/science-career-tempenv/lib/python3.9/site-packages/numpy/core/getlimits.py:500: UserWarning: The value of the smallest subnormal for <class 'numpy.float64'> type is zero.
  setattr(self, word, getattr(machar, word).flat[0])
/home/flavio/miniconda3/envs/science-career-tempenv/lib/python3.9/site-packages/numpy/core/getlimits.py:89: UserWarning: The value of the smallest subnormal for <class 'numpy.float64'> type is zero.
  return self._float_to_str(self.smallest_subnormal)
/home/flavio/miniconda3/envs/science-career-tempenv/lib/python3.9/site-packages/numpy/core/getlimits.py:500: UserWarning: The value of the smallest subnormal for <class 'numpy.float32'> type is zero.
  setattr(self, word, getattr(machar, word).flat[0])
/home/flavio/miniconda3/envs/science-career-tempenv/lib/python3.9/site-packages/numpy/core/getlimits.py:89: UserWarning: The value of the smallest subnormal for <class 'numpy.float32'> type is zero.
  return self._float_to_str(self.smallest_subnormal)
Namespace(testing=True, verbose=1, field=['economics'], train_name='flavio_baseline', startyear=1985, endyear=2022, mergemode='1:1', recall=0.9, institution='True', fieldofstudy_cat='False', fieldofstudy_str='False', keywords='False', retrain='True', linking_type='grants')
Have max 6 cores available
Testing is True 

finished setup ... 
INFO:dedupe.training:Final predicate set:
INFO:dedupe.training:SimplePredicate: (tokenFieldPredicate, lastname)
firstname : steven
lastname : puller
middlename : l
us_institutions_year : ((1999, 'university of california berkeley'), (2006, 'texas a m university'), (2007, 'texas a m university'), (2008, 'texas a m university'), (2009, 'texas a m university'), (2011, 'texas a m university'), (2012, 'texas a m university'), (2013, 'texas a m university'), (2017, 'texas a m university'), (2019, 'texas a m university'))

firstname : steven
lastname : miller
middlename : None
us_institutions_year : ((2021, 'clemson university'),)

0/10 positive, 0/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished

        SELECT a.GrantID, CAST(SUBSTR(a.Award_AwardEffectiveDate, 7, 4) AS INT) AS year
            , b.institution, c.firstname, c.lastname, c.middlename
            , '' AS keywords, '' AS coauthors -- # necessary for current code structure
            , CAST(SUBSTR(a.Award_AwardEffectiveDate, 7, 4) AS INT) || "//" || b.institution AS us_institutions_year
        FROM NSF_MAIN as a 
        INNER JOIN (
            SELECT GrantID, Name AS institution
            FROM NSF_Institution
        ) b 
        USING (GrantID)
        INNER JOIN (
            SELECT GrantID
                , FirstName AS firstname
                , LastName AS lastname
                , PIMidInit AS middlename --# NOTE: PISufxName is often "Jr", "Mr", JR, ... 
            FROM NSF_Investigator
            WHERE RoleCode = 'principal investigator'
        ) c
        USING (GrantID)
        WHERE AWARD_TranType = 'grant' AND AWARD_Agency = 'nsf' 
            AND a.AwardInstrument_Value IN ('standard grant', 'continuing grant')
            AND a.Organization_Directorate_ShortName IN ('SOCIAL, BEHAV & ECONOMIC SCIE')
            AND c.lastname != 'data not available'
         LIMIT 500 


    SELECT f.AuthorId
        , f.year
        , f.YearLastPub
        , f.firstname
        , f.lastname
        , CASE TRIM(SUBSTR(f.middle_lastname, 1, f.l_fullname - f.l_firstname - f.l_lastname - 1)) 
            WHEN 
                "" THEN NULL 
                ELSE TRIM(SUBSTR(f.middle_lastname, 1, f.l_fullname - f.l_firstname - f.l_lastname - 1)) 
            END as middlename 
            -- ## NOTE this gives "" for middlename when it is missing 
        , f.fieldofstudy
        , g.keywords
        , g.coauthors
        , g.institution
        , g.us_institutions_year
    FROM (
        SELECT a.AuthorId
            , a.YearFirstPub AS year
            , a.YearLastPub 
            , a.FirstName AS firstname
            , REPLACE(b.NormalizedName, RTRIM(b.NormalizedName, REPLACE(b.NormalizedName, " ", "")), "") AS lastname 
                    -- https://stackoverflow.com/questions/21388820/how-to-get-the-last-index-of-a-substring-in-sqlite
            , TRIM(SUBSTR(b.NormalizedName, length(a.FirstName) + 1)) AS middle_lastname 
                    -- this gives all except the first name 
            , length(b.NormalizedName) as l_fullname 
            , length(a.FirstName) as l_firstname
            , length(REPLACE(b.NormalizedName, RTRIM(b.NormalizedName, REPLACE(b.NormalizedName, " ", "")), "")) as l_lastname
            , e.NormalizedName AS fieldofstudy
        FROM author_sample AS a
        INNER JOIN (
            SELECT AuthorId, NormalizedName
            FROM Authors
        ) AS b USING(AuthorId)
        INNER JOIN (
            -- ## mark: different from linking graduates. filter on field0
            SELECT AuthorId, NormalizedName
            FROM author_fields c
            INNER JOIN (
                SELECT FieldOfStudyId, NormalizedName
                FROM FieldsOfStudy
            ) AS d USING(FieldOfStudyId)
            WHERE FieldClass = 'main'
                AND FieldOfStudyId IN (?)
        ) AS e USING(AuthorId)
    ) f
    LEFT JOIN (
        SELECT AuthorId
                , us_institutions_career as institution
                , coauthors
                , keywords
                , us_institutions_year
        FROM author_info_linking
    ) AS g USING(AuthorId)
    
    WHERE length(firstname) > 1 AND f.YearLastPub >= 1985 - 5 AND year <= 2022 + 5 AND institution is not NULL
     LIMIT 500 

Starting active labeling...
firstname : jean
lastname : helwege
middlename : None
us_institutions_year : ((1996, 'federal reserve bank of new york'), (1997, 'federal reserve bank of new york'), (1998, 'federal reserve bank of new york'), (1999, 'federal reserve bank of new york'), (1999, 'ohio state university'), (2003, 'ohio state university'), (2004, 'university of arizona'), (2007, 'pennsylvania state university'), (2008, 'pennsylvania state university'), (2009, 'pennsylvania state university'), (2010, 'pennsylvania state university'), (2011, 'university of south carolina'), (2012, 'university of south carolina'), (2013, 'university of south carolina'), (2014, 'university of south carolina'), (2015, 'university of california riverside'), (2016, 'university of california riverside'), (2017, 'university of california riverside'), (2020, 'university of california riverside'))

firstname : jiangen
lastname : he
middlename : None
us_institutions_year : ((2021, 'university of tennessee knoxville'),)

1/10 positive, 0/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
INFO:dedupe.training:Final predicate set:
INFO:dedupe.training:LevenshteinSearchPredicate: (2, lastname)
firstname : michael
lastname : depersio
middlename : None
us_institutions_year : ((2012, 'united states census bureau'),)

firstname : michael
lastname : dove
middlename : r
us_institutions_year : ((2021, 'yale university'),)

1/10 positive, 1/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : robert
lastname : korajczyk
middlename : a
us_institutions_year : ((1986, 'northwestern university'), (1988, 'northwestern university'), (1989, 'northwestern university'), (1991, 'northwestern university'), (1991, 'university of chicago'), (1992, 'northwestern university'), (1995, 'northwestern university'), (2002, 'northwestern university'), (2003, 'northwestern university'), (2006, 'northwestern university'), (2008, 'northwestern university'), (2011, 'northwestern university'), (2014, 'northwestern university'), (2018, 'northwestern university'), (2019, 'northwestern university'))

firstname : robert
lastname : cook
middlename : a
us_institutions_year : ((2021, 'ohio state university'),)

2/10 positive, 1/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
INFO:dedupe.training:Final predicate set:
INFO:dedupe.training:SimplePredicate: (tokenFieldPredicate, lastname)
INFO:dedupe.training:SimplePredicate: (commonSixGram, firstname)
firstname : david
lastname : slegers
middlename : w
us_institutions_year : ((2000, 'bowling green state university'), (2007, 'university of kansas'))

firstname : david
lastname : chiang
middlename : w
us_institutions_year : ((2021, 'university of notre dame'),)

2/10 positive, 2/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : robin
lastname : sickles
middlename : c
us_institutions_year : ((1979, 'university of pennsylvania'), (1982, 'university of pennsylvania'), (1983, 'university of pennsylvania'), (1984, 'university of pennsylvania'), (1985, 'university of pennsylvania'), (1986, 'rice university'), (1988, 'rice university'), (1989, 'rice university'), (1990, 'rice university'), (1991, 'rice university'), (1992, 'rice university'), (1993, 'university of michigan'), (1994, 'rice university'), (1995, 'rice university'), (1997, 'rice university'), (1998, 'rice university'), (2000, 'rice university'), (2002, 'rice university'), (2003, 'rice university'), (2004, 'rice university'), (2005, 'rice university'), (2006, 'rice university'), (2007, 'rice university'), (2008, 'rice university'), (2009, 'rice university'), (2010, 'rice university'), (2011, 'rice university'), (2012, 'rice university'), (2013, 'rice university'), (2014, 'rice university'), (2015, 'rice university'), (2016, 'rice university'), (2017, 'rice university'), (2018, 'rice university'), (2019, 'rice university'), (2020, 'rice university'), (2021, 'rice university'))

firstname : robin
lastname : beck
middlename : None
us_institutions_year : ((2022, 'regents of the university of michigan ann arbor'),)

3/10 positive, 2/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
INFO:dedupe.training:Final predicate set:
INFO:dedupe.training:SimplePredicate: (tokenFieldPredicate, lastname)
INFO:dedupe.training:SimplePredicate: (suffixArray, firstname)
firstname : john
lastname : zerbinis
middlename : None
us_institutions_year : ((1981, 'university of california santa barbara'),)

firstname : john
lastname : gerring
middlename : None
us_institutions_year : ((2021, 'university of texas at austin'),)

3/10 positive, 3/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : alex
lastname : warrenrodriguez
middlename : None
us_institutions_year : ((2010, 'united nations development programme'), (2016, 'united nations development programme'))

firstname : alex
lastname : mayer
middlename : s
us_institutions_year : ((2022, 'university of texas at el paso'),)

4/10 positive, 3/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
INFO:dedupe.training:Final predicate set:
INFO:dedupe.training:SimplePredicate: (wholeFieldPredicate, firstname)
firstname : andreas
lastname : waldkirch
middlename : None
us_institutions_year : ((2003, 'oregon state university'), (2004, 'oregon state university'), (2006, 'colby college'), (2008, 'colby college'), (2009, 'colby college'), (2010, 'colby college'), (2011, 'colby college'), (2012, 'colby college'), (2015, 'colby college'), (2016, 'colby college'), (2021, 'colby college'))

firstname : andrea
lastname : wiley
middlename : None
us_institutions_year : ((2021, 'indiana university'),)

4/10 positive, 4/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : john
lastname : zerbinis
middlename : None
us_institutions_year : ((1981, 'university of california santa barbara'),)

firstname : john
lastname : chatagnier
middlename : t
us_institutions_year : ((2021, 'university of houston'),)

5/10 positive, 4/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
INFO:dedupe.training:Final predicate set:
INFO:dedupe.training:TfidfNGramSearchPredicate: (0.8, firstname)
firstname : nicoletta
lastname : batini
middlename : None
us_institutions_year : ((2004, 'international monetary fund'), (2005, 'international monetary fund'), (2006, 'international monetary fund'), (2006, 'federal reserve system'), (2010, 'international monetary fund'), (2019, 'international monetary fund'))

firstname : nicole
lastname : davi
middlename : k
us_institutions_year : ((2021, 'william paterson university'),)

5/10 positive, 5/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : marc
lastname : melitz
middlename : j
us_institutions_year : ((2003, 'harvard university'), (2004, 'center for economic and policy research'), (2004, 'harvard university'), (2004, 'national bureau of economic research'), (2005, 'harvard university'), (2005, 'national bureau of economic research'), (2007, 'boston college'), (2007, 'princeton university'), (2008, 'princeton university'), (2008, 'national bureau of economic research'), (2010, 'harvard university'), (2012, 'harvard university'), (2014, 'harvard university'), (2015, 'harvard university'), (2018, 'harvard university'), (2019, 'harvard university'), (2020, 'harvard university'))

firstname : marcela
lastname : benitez
middlename : e
us_institutions_year : ((2021, 'emory university'),)

6/10 positive, 5/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
INFO:dedupe.training:Final predicate set:
INFO:dedupe.training:SimplePredicate: (sameFiveCharStartPredicate, firstname)
firstname : daniele
lastname : bondonio
middlename : None
us_institutions_year : ((1998, 'carnegie mellon university'), (2000, 'carnegie mellon university'))

firstname : dani
lastname : byrd
middlename : None
us_institutions_year : ((2021, 'university of southern california'),)

6/10 positive, 6/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : joelle
lastname : saadlessler
middlename : None
us_institutions_year : ((2005, 'long island university'), (2010, 'long island university'), (2014, 'the new school'), (2015, 'the new school'), (2017, 'stevens institute of technology'), (2019, 'stevens institute of technology'), (2020, 'stevens institute of technology'))

firstname : joel
lastname : sobel
middlename : None
us_institutions_year : ((2021, 'university of california san diego'),)

7/10 positive, 6/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
INFO:dedupe.training:Final predicate set:
INFO:dedupe.training:TfidfNGramSearchPredicate: (0.6, firstname)
firstname : martin
lastname : mendozabotelho
middlename : None
us_institutions_year : ((2011, 'tulane university'), (2013, 'tulane university'))

firstname : m
lastname : hood
middlename : v
us_institutions_year : ((2020, 'university of georgia research foundation inc'),)

7/10 positive, 7/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : marie
lastname : hoerova
middlename : None
us_institutions_year : ((2012, 'economic policy institute'),)

firstname : m
lastname : hood
middlename : v
us_institutions_year : ((2020, 'university of georgia research foundation inc'),)

8/10 positive, 7/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
INFO:dedupe.training:Final predicate set:
INFO:dedupe.training:SimplePredicate: (sortedAcronym, firstname)
firstname : catherine
lastname : bonserneal
middlename : None
us_institutions_year : ((1990, 'university of washington'), (1996, 'federal reserve bank of kansas city'), (1999, 'indiana university'), (2000, 'indiana university'))

firstname : katherine
lastname : foo
middlename : e
us_institutions_year : ((2022, 'worcester polytechnic institute'),)

8/10 positive, 8/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : stefan
lastname : zeume
middlename : None
us_institutions_year : ((2017, 'university of michigan'), (2018, 'university of michigan'), (2019, 'university of illinois at urbana champaign'), (2019, 'university of michigan'), (2020, 'university of illinois at urbana champaign'))

firstname : stefan
lastname : leyk
middlename : None
us_institutions_year : ((2021, 'university of colorado at boulder'),)

9/10 positive, 8/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
INFO:dedupe.training:Final predicate set:
INFO:dedupe.training:SimplePredicate: (sortedAcronym, firstname)
INFO:dedupe.training:SimplePredicate: (commonSixGram, firstname)
firstname : annette
lastname : vissingjorgensen
middlename : None
us_institutions_year : ((2002, 'university of chicago'), (2006, 'national bureau of economic research'), (2009, 'northwestern university'), (2012, 'northwestern university'), (2014, 'university of california berkeley'), (2015, 'center for economic and policy research'), (2015, 'university of california berkeley'), (2015, 'national bureau of economic research'), (2018, 'university of california berkeley'), (2019, 'university of california berkeley'), (2019, 'national bureau of economic research'), (2020, 'university of california berkeley'))

firstname : anne
lastname : barnhill
middlename : None
us_institutions_year : ((2021, 'johns hopkins university'),)

9/10 positive, 9/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : deborah
lastname : allness
middlename : j
us_institutions_year : ((1980, 'mendota mental health institute'), (1997, 'mendota mental health institute'))

firstname : deborah
lastname : balk
middlename : None
us_institutions_year : ((2021, 'cuny baruch college'),)

10/10 positive, 9/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : john
lastname : boschen
middlename : f
us_institutions_year : ((1982, 'tulane university'), (1985, 'tulane university'), (1987, 'tulane university'), (1988, 'tulane university'), (1993, 'college of william mary'), (1995, 'college of william mary'), (2001, 'college of william mary'), (2003, 'college of william mary'), (2004, 'college of william mary'), (2012, 'college of william mary'), (2016, 'college of william mary'))

firstname : john david
lastname : smith
middlename : None
us_institutions_year : ((2021, 'georgia state university research foundation inc'),)

10/10 positive, 10/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
Finished labeling
INFO:rlr.crossvalidation:using cross validation to find optimum alpha...
INFO:rlr.crossvalidation:optimum alpha: 0.000010, score -0.05717591443834086
INFO:dedupe.training:Final predicate set:
INFO:dedupe.training:TfidfNGramSearchPredicate: (0.6, firstname)
Done in 1.6149225155512492 minutes.
