Namespace(testing=False, verbose=1, field=['economics'], train_name='flavio_baseline', startyear=1985, endyear=2022, mergemode='1:1', recall=0.9, institution='True', fieldofstudy_cat='False', fieldofstudy_str='False', keywords='False', retrain='True', linking_type='grants')
Have max 6 cores available
Testing is False 

finished setup ... 
firstname : john
lastname : evans
middlename : t
institution : ('long island university',)

firstname : john
lastname : evans
middlename : p
institution : ('university of north carolina at chapel hill',)

0/10 positive, 0/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished

        SELECT a.GrantID, CAST(SUBSTR(a.Award_AwardEffectiveDate, 7, 4) AS INT) AS year
            , b.institution, c.firstname, c.lastname, c.middlename
            , '' AS keywords, '' AS coauthors -- # necessary for current code structure
        FROM NSF_MAIN as a 
        INNER JOIN (
            SELECT GrantID, Name AS institution
            FROM NSF_Institution
        ) b 
        USING (GrantID)
        INNER JOIN (
            SELECT GrantID
                , FirstName AS firstname
                , LastName AS lastname
                , PIMidInit AS middlename --# NOTE: PISufxName is often "Jr", "Mr", JR, ... 
            FROM NSF_Investigator
            WHERE RoleCode = 'principal investigator'
        ) c
        USING (GrantID)
        WHERE AWARD_TranType = 'grant' AND AWARD_Agency = 'nsf' 
         


    SELECT f.AuthorId
        , f.year
        , f.firstname
        , f.lastname
        , CASE TRIM(SUBSTR(f.middle_lastname, 1, f.l_fullname - f.l_firstname - f.l_lastname - 1)) 
            WHEN 
                "" THEN NULL 
                ELSE TRIM(SUBSTR(f.middle_lastname, 1, f.l_fullname - f.l_firstname - f.l_lastname - 1)) 
            END as middlename 
            -- ## NOTE this gives "" for middlename when it is missing 
        , f.fieldofstudy
        , g.keywords
        , g.coauthors
        , g.institution
    FROM (
        SELECT a.AuthorId
            , a.YearFirstPub AS year
            , a.FirstName AS firstname
            , REPLACE(b.NormalizedName, RTRIM(b.NormalizedName, REPLACE(b.NormalizedName, " ", "")), "") AS lastname 
                    -- https://stackoverflow.com/questions/21388820/how-to-get-the-last-index-of-a-substring-in-sqlite
            , TRIM(SUBSTR(b.NormalizedName, length(a.FirstName) + 1)) AS middle_lastname 
                    -- this gives all except the first name 
            , length(b.NormalizedName) as l_fullname 
            , length(a.FirstName) as l_firstname
            , length(REPLACE(b.NormalizedName, RTRIM(b.NormalizedName, REPLACE(b.NormalizedName, " ", "")), "")) as l_lastname
            , e.NormalizedName AS fieldofstudy
        FROM author_sample AS a
        INNER JOIN (
            SELECT AuthorId, NormalizedName
            FROM Authors
        ) AS b USING(AuthorId)
        INNER JOIN (
            -- ## mark: different from linking graduates. filter on field0
            SELECT AuthorId, NormalizedName
            FROM author_fields c
            INNER JOIN (
                SELECT FieldOfStudyId, NormalizedName
                FROM FieldsOfStudy
            ) AS d USING(FieldOfStudyId)
            WHERE FieldClass = 'main'
                AND FieldOfStudyId IN (?)
        ) AS e USING(AuthorId)
    ) f
    LEFT JOIN (
        SELECT AuthorId
                , us_institutions_career as institution
                , coauthors
                , keywords
        FROM author_info_linking
    ) AS g USING(AuthorId)
    INNER JOIN (
        SELECT AuthorId
        FROM current_links
    ) AS f USING(AuthorId)
    WHERE length(firstname) > 1 AND year >= 1985 - 5 AND year <= 2022 + 5 
     

Starting active labeling...
firstname : robert
lastname : olsen
middlename : None
institution : None

firstname : robert
lastname : olsen
middlename : g
institution : ('individual award',)

1/10 positive, 0/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : john
lastname : evans
middlename : t
institution : ('long island university',)

firstname : john
lastname : evans
middlename : p
institution : ('university of north carolina at chapel hill',)

0/10 positive, 0/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished
firstname : robert
lastname : olsen
middlename : None
institution : None

firstname : robert
lastname : olsen
middlename : g
institution : ('individual award',)

0/10 positive, 1/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : changjin
lastname : kim
middlename : None
institution : ('university of washington',)

firstname : chang jin
lastname : kim
middlename : None
institution : ('university of california los angeles',)

0/10 positive, 2/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : ming
lastname : liu
middlename : None
institution : ('duke university',)

firstname : lingjia
lastname : liu
middlename : None
institution : ('virginia polytechnic institute and state university',)

0/10 positive, 3/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : mark
lastname : lautzenheiser
middlename : None
institution : ('earlham college',)

firstname : mark
lastname : paul
middlename : r
institution : ('virginia polytechnic institute and state university',)

0/10 positive, 4/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : robert
lastname : zeithammer
middlename : None
institution : ('massachusetts institute of technology', 'university of california los angeles', 'university of chicago')

firstname : robert
lastname : pego
middlename : l
institution : ('carnegie mellon university',)

0/10 positive, 5/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : david
lastname : armstrong
middlename : None
institution : None

firstname : david
lastname : armstrong
middlename : s
institution : ('college of william and mary',)

0/10 positive, 6/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : paul
lastname : johnson
middlename : None
institution : None

firstname : paul
lastname : johnson
middlename : None
institution : ('university of new hampshire',)

0/10 positive, 7/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : margot
lastname : anderson
middlename : None
institution : ('united states department of agriculture',)

firstname : ian
lastname : anderson
middlename : m
institution : ('utah state university',)

0/10 positive, 8/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : melonie
lastname : williams
middlename : None
institution : ('united states environmental protection agency',)

firstname : mark
lastname : williams
middlename : None
institution : ('northeastern university',)

0/10 positive, 9/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : john
lastname : williams
middlename : c
institution : ('federal reserve bank of new york', 'federal reserve bank of san francisco', 'federal reserve system')

firstname : roselyn
lastname : williams
middlename : None
institution : ('american institute of mathematics',)

0/10 positive, 10/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : mary
lastname : edwards
middlename : None
institution : None

firstname : margo
lastname : edwards
middlename : h
institution : ('university of hawaii',)

0/10 positive, 11/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : andrew
lastname : samuel
middlename : None
institution : ('loyola university chicago', 'loyola university maryland', 'university of baltimore')

firstname : aravinthan d
lastname : samuel
middlename : t
institution : ('harvard university',)

0/10 positive, 12/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : christopher
lastname : martin
middlename : None
institution : ('st john s university',)

firstname : thomas
lastname : martin
middlename : e
institution : ('university of arkansas',)

0/10 positive, 13/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : margot
lastname : anderson
middlename : None
institution : ('united states department of agriculture',)

firstname : taylor
lastname : anderson
middlename : m
institution : ('george mason university',)

0/10 positive, 14/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : shon
lastname : williams
middlename : p
institution : ('american express', 'washington state university')

firstname : roselyn
lastname : williams
middlename : None
institution : ('american institute of mathematics',)

0/10 positive, 15/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : mark
lastname : thompson
middlename : a
institution : ('marshall university',)

firstname : r bruce
lastname : thompson
middlename : None
institution : ('iowa state university',)

0/10 positive, 16/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : nicolas
lastname : williams
middlename : None
institution : ('university of cincinnati',)

firstname : mark
lastname : williams
middlename : None
institution : ('northeastern university',)

0/10 positive, 17/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : greg
lastname : anderson
middlename : None
institution : ('bank of america merrill lynch',)

firstname : krister
lastname : andersson
middlename : p
institution : ('university of colorado at boulder',)

0/10 positive, 18/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : michael
lastname : johnson
middlename : a
institution : ('indiana university purdue university indianapolis', 'purdue university')

firstname : paul
lastname : johnson
middlename : None
institution : ('university of new hampshire',)

0/10 positive, 19/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : mark
lastname : miller
middlename : None
institution : ('university of maryland college park',)

firstname : gregory
lastname : miller
middlename : h
institution : ('university of chicago',)

0/10 positive, 20/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : christopher
lastname : martin
middlename : None
institution : ('st john s university',)

firstname : randall
lastname : martin
middlename : v
institution : ('washington university',)

0/10 positive, 21/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : greg
lastname : anderson
middlename : None
institution : ('bank of america merrill lynch',)

firstname : robert
lastname : anderson
middlename : s
institution : ('university of california santa cruz',)

0/10 positive, 22/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : paul
lastname : johnson
middlename : None
institution : None

firstname : william
lastname : johnson
middlename : b
institution : ('texas a m university',)

0/10 positive, 23/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : margot
lastname : anderson
middlename : None
institution : ('united states department of agriculture',)

firstname : robert
lastname : anderson
middlename : s
institution : ('university of california santa cruz',)

0/10 positive, 24/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : margot
lastname : anderson
middlename : None
institution : ('united states department of agriculture',)

firstname : daniel
lastname : anderson
middlename : r
institution : ('university of massachusetts amherst',)

0/10 positive, 25/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : greg
lastname : anderson
middlename : None
institution : ('bank of america merrill lynch',)

firstname : donald
lastname : anderson
middlename : m
institution : ('woods hole oceanographic institution',)

0/10 positive, 26/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : greg
lastname : anderson
middlename : None
institution : ('bank of america merrill lynch',)

firstname : robert
lastname : anderson
middlename : None
institution : ('columbia university',)

0/10 positive, 27/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : greg
lastname : anderson
middlename : None
institution : ('bank of america merrill lynch',)

firstname : robert
lastname : anderson
middlename : None
institution : ('columbia university',)

0/10 positive, 28/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : mark
lastname : miller
middlename : None
institution : ('university of maryland college park',)

firstname : thomas
lastname : miller
middlename : e
institution : ('florida state university',)

0/10 positive, 29/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : greg
lastname : anderson
middlename : None
institution : ('bank of america merrill lynch',)

firstname : daniel
lastname : anderson
middlename : r
institution : ('university of massachusetts amherst',)

0/10 positive, 30/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : nicolas
lastname : williams
middlename : None
institution : ('university of cincinnati',)

firstname : roselyn
lastname : williams
middlename : None
institution : ('american institute of mathematics',)

0/10 positive, 31/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : margot
lastname : anderson
middlename : None
institution : ('united states department of agriculture',)

firstname : robert
lastname : anderson
middlename : None
institution : ('columbia university',)

0/10 positive, 32/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : margot
lastname : anderson
middlename : None
institution : ('united states department of agriculture',)

firstname : robert
lastname : anderson
middlename : None
institution : ('columbia university',)

0/10 positive, 33/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : greg
lastname : anderson
middlename : None
institution : ('bank of america merrill lynch',)

firstname : taylor
lastname : anderson
middlename : m
institution : ('george mason university',)

0/10 positive, 34/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : justin
lastname : johnson
middlename : p
institution : ('cornell university',)

firstname : paul
lastname : johnson
middlename : None
institution : ('university of new hampshire',)

0/10 positive, 35/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : evan
lastname : anderson
middlename : w
institution : ('northern illinois university', 'university of north carolina at chapel hill')

firstname : robert
lastname : anderson
middlename : None
institution : ('columbia university',)

0/10 positive, 36/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : evan
lastname : anderson
middlename : w
institution : ('northern illinois university', 'university of north carolina at chapel hill')

firstname : robert
lastname : anderson
middlename : None
institution : ('columbia university',)

0/10 positive, 37/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : wolfgang
lastname : keller
middlename : None
institution : ('economic policy institute', 'national bureau of economic research', 'university of colorado boulder', 'university of texas at austin', 'university of wisconsin madison')

firstname : edward
lastname : keller
middlename : l
institution : ('medical research institute',)

0/10 positive, 38/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : margot
lastname : anderson
middlename : None
institution : ('united states department of agriculture',)

firstname : john
lastname : anderson
middlename : s
institution : ('university of chicago',)

0/10 positive, 39/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : john
lastname : roberts
middlename : None
institution : None

firstname : robert
lastname : roberts
middlename : None
institution : ('institute for defense analyses',)

0/10 positive, 40/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : richard
lastname : thompson
middlename : p
institution : ('california polytechnic state university',)

firstname : r bruce
lastname : thompson
middlename : None
institution : ('iowa state university',)

0/10 positive, 41/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : mark
lastname : thompson
middlename : a
institution : ('marshall university',)

firstname : carl
lastname : thompson
middlename : v
institution : ('massachusetts institute of technology',)

0/10 positive, 42/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : greg
lastname : anderson
middlename : None
institution : ('bank of america merrill lynch',)

firstname : ian
lastname : anderson
middlename : m
institution : ('utah state university',)

0/10 positive, 43/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : paul
lastname : patterson
middlename : m
institution : ('agricultural applied economics association', 'arizona state university', 'auburn university')

firstname : stacy
lastname : patterson
middlename : None
institution : ('rensselaer polytechnic institute',)

0/10 positive, 44/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : melonie
lastname : williams
middlename : None
institution : ('united states environmental protection agency',)

firstname : roselyn
lastname : williams
middlename : None
institution : ('american institute of mathematics',)

0/10 positive, 45/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : lori
lastname : taylor
middlename : l
institution : ('federal reserve bank of dallas', 'southern methodist university', 'texas a m university', 'west texas a m university')

firstname : brian
lastname : taylor
middlename : None
institution : ('university of hawaii',)

0/10 positive, 46/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : nathan
lastname : anderson
middlename : b
institution : ('case western reserve university', 'university of illinois at chicago')

firstname : ian
lastname : anderson
middlename : m
institution : ('utah state university',)

0/10 positive, 47/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : federico
lastname : garcia
middlename : None
institution : ('center for naval analyses',)

firstname : miguel
lastname : garcia garibay
middlename : a
institution : ('university of california los angeles',)

0/10 positive, 48/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : scott
lastname : dressler
middlename : j
institution : ('villanova university',)

firstname : alan
lastname : dressler
middlename : None
institution : ('carnegie institution of washington',)

0/10 positive, 49/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : joyce
lastname : jacobsen
middlename : p
institution : ('rhodes college', 'wesleyan university')

firstname : gustaaf
lastname : jacobs
middlename : None
institution : ('san diego state university foundation',)

0/10 positive, 50/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : arthur
lastname : thomas
middlename : c
institution : ('agricultural applied economics association',)

firstname : james
lastname : thomas
middlename : None
institution : ('university of mississippi',)

0/10 positive, 51/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
firstname : john
lastname : stevens
middlename : j
institution : ('federal reserve system',)

firstname : chandler
lastname : stevens
middlename : h
institution : ('participation systems inc',)

0/10 positive, 52/10 negative
Do these records refer to the same thing?
(y)es / (n)o / (u)nsure / (f)inished / (p)revious
Finished labeling
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/flavio/projects/mag_sample/src/dataprep/main/link/train_link_mag_proquest.py", line 204, in <module>
    linker.train(recall = args.recall)
  File "/home/flavio/.local/lib/python3.10/site-packages/dedupe/api.py", line 1127, in train
    self.classifier.fit(self.data_model.distances(examples), y)
  File "/home/flavio/.local/lib/python3.10/site-packages/sklearn/model_selection/_search.py", line 875, in fit
    self._run_search(evaluate_candidates)
  File "/home/flavio/.local/lib/python3.10/site-packages/sklearn/model_selection/_search.py", line 1375, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "/home/flavio/.local/lib/python3.10/site-packages/sklearn/model_selection/_search.py", line 852, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "/home/flavio/.local/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 367, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 35 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
35 fits failed with the following error:
Traceback (most recent call last):
  File "/home/flavio/.local/lib/python3.10/site-packages/sklearn/model_selection/_validation.py", line 686, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "/home/flavio/.local/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py", line 1183, in fit
    raise ValueError(
ValueError: This solver needs samples of at least 2 classes in the data, but the data contains only one class: 0

